

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Bierschaumzerfall &#8212; Modellbildung und Simulation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/mystnb.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .secondtoggle, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script async="async" src="../_static/thebelab.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Interpolation und Approximation" href="../05_interp_approx/00_interpolation_Und_approximation.html" />
    <link rel="prev" title="Nichtlineare Gleichungssysteme" href="00_nichtlineare_gleichungssysteme.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/hbrs_logo_text.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Modellbildung und Simulation</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
  <ul class="nav sidenav_l1">
  <li class="">
    <a href="../00_einleitung/00_einleitung.html">Einleitung</a>
  </li>
  <li class="">
    <a href="../01_schwingungen/00_schwingungen.html">Schwingungen</a>
  </li>
  <li class="">
    <a href="../02_lineare_gleichungen/00_lineare_gleichungssysteme.html">Lineare Gleichungssysteme</a>
  </li>
  <li class="">
    <a href="../03_gleitkommaarithmetik/00_gleitkommaarithmetik.html">Gleitkommaarithmetik</a>
  </li>
  <li class="active">
    <a href="00_nichtlineare_gleichungssysteme.html">Nichtlineare Gleichungssysteme</a>
  <ul class="nav sidenav_l2">
    <li class="active">
      <a href="">Bierschaumzerfall</a>
    </li>
  </ul>
  </li>
  <li class="">
    <a href="../05_interp_approx/00_interpolation_Und_approximation.html">Interpolation und Approximation</a>
  </li>
  <li class="">
    <a href="../06_Differentiation_Integration/00_differentiation_und_integration.html">Differentiation und Integration</a>
  </li>
  <li class="">
    <a href="../07_num_ode/00_numerik_gewöhnlicher_differentialgleichungen.html">Numerik gewöhnlicher Differentialgleichungen</a>
  </li>
  <li class="">
    <a href="../08_eigenwerte/00_eigenwertprobleme.html">Eigenwertprobleme</a>
  </li>
  <li class="">
    <a href="../09_dft/00_diskrete_fouriertransformation.html">Diskrete Fouriertransformation</a>
  </li>
  <li class="">
    <a href="../10_bvp/00_randwertprobleme.html">Randwertprobleme</a>
  </li>
</ul>
</nav>
<p class="navbar_footer"><div align="left"> <a href="https://github.com/joergbrech/Modellbildung-und-Simulation"><img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" style="width: 20px;"> Github Repository</a> <br> <a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="https://upload.wikimedia.org/wikipedia/commons/d/d0/CC-BY-SA_icon.svg" alt="License: CC BY-SA 4.0"></a> <br> <a href="https://doi.org/10.5281/zenodo.2560551"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.2560551.svg" alt="DOI"></a> <br>Powered by <a href="https://github.com/jupyter/jupyter-book">Jupyter Book</a> </div></p>
</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse" data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu" aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation" title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i class="fas fa-download"></i></button>

            
            <div class="dropdown-buttons">
                <!-- ipynb file if we had a myst markdown file -->
                
                <!-- Download raw file -->
                <a class="dropdown-buttons" href="../_sources/04_nichtlineare_gleichungen/01_bierschaumzerfall.ipynb.txt"><button type="button" class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip" data-placement="left">.ipynb</button></a>
                <!-- Download PDF via print -->
                <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF" onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
            </div>
            
        </div>

        <!-- Edit this page -->
        <a class="edit-button" href="https://github.com/joergbrech/Modellbildung-und-Simulation/edit/master/content/04_nichtlineare_gleichungen/01_bierschaumzerfall.ipynb"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="bottom" title="Edit this page"><i class="fas fa-pencil-alt"></i></button></a>

        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->
        
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
            <div class="dropdown-buttons">
                
                <a class="binder-button" href="https://mybinder.org/v2/gh/joergbrech/Modellbildung-und-Simulation/master?urlpath=lab/tree/content/04_nichtlineare_gleichungen/01_bierschaumzerfall.ipynb"><button type="button" class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip" data-placement="left"><img class="binder-button-logo" src="../_static/images/logo_binder.svg" alt="Interact on binder">Binder</button></a>
                
                
                <button type="button" class="btn btn-secondary topbarbtn thebelab-launch-button" onclick="initThebelab()" title="Launch Thebelab" data-toggle="tooltip" data-placement="left"><i class="fas fa-rocket"></i><span style="margin-left: .4em;">ThebeLab</span></button>
                
            </div>
        </div>
        
    </div>
    <div class="d-none d-md-block col-md-2 bd-toc show">
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#experimenteller-aufbau" class="nav-link">Experimenteller Aufbau</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#modellbeschreibung" class="nav-link">Modellbeschreibung</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#die-methode-der-kleinsten-quadrate" class="nav-link">Die Methode der kleinsten Quadrate</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#die-grundidee" class="nav-link">Die Grundidee</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#anwendung-auf-den-bierschaum" class="nav-link">Anwendung auf den Bierschaum</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#aufgabe-1-das-nichtlineare-gleichungssystem" class="nav-link">Aufgabe 1: Das nichtlineare Gleichungssystem</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#das-newton-verfahren" class="nav-link">Das Newton-Verfahren</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#aufgabe-2-approximation-der-jacobi-matrix" class="nav-link">Aufgabe 2: Approximation der Jacobi-Matrix</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#aufgabe-3-parameterbestimmung" class="nav-link">Aufgabe 3: Parameterbestimmung</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#optimierungsverfahren" class="nav-link">Optimierungsverfahren</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#aufgabe-4-algorithmus-zur-minimierung-einer-funktion" class="nav-link">Aufgabe 4: Algorithmus zur Minimierung einer Funktion</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#zusatzliche-informationen" class="nav-link">Zusätzliche Informationen</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#literatur" class="nav-link">Literatur</a>
        </li>
    
    </ul>
</nav>



<div class="tocsection editthispage">
    <a href="https://github.com/joergbrech/Modellbildung-und-Simulation/edit/master/content/04_nichtlineare_gleichungen/01_bierschaumzerfall.ipynb">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="bierschaumzerfall">
<h1>Bierschaumzerfall<a class="headerlink" href="#bierschaumzerfall" title="Permalink to this headline">¶</a></h1>
<p><img alt="" src="../_images/weizenbier.jpg" /></p>
<p>Wenn wir ein Weizenbier länger stehen lassen, baut sich die schöne Schaumkrone ab. Aber wie schnell eigentlich?</p>
<div class="section" id="experimenteller-aufbau">
<h2>Experimenteller Aufbau<a class="headerlink" href="#experimenteller-aufbau" title="Permalink to this headline">¶</a></h2>
<p>Messen wir es einfach nach! Wir benutzen einen Messbecher, Wasser und einen wasserfesten Marker, um ein Weizenglas mit Eichstrichen zu versehen <em>(Hier hätten wir natürlich auch direkt den Messbecher benutzen können, wir entscheiden uns aber, etwas Messgenauigkeit zu Gunsten der Realitätsnähe zu opfern)</em>.</p>
<p><img alt="" src="../_images/20190521_bierschaum_01.jpg" /></p>
<p>Wir schütten ein Bier so in das geeichte Glas ein, dass sehr viel Schaum entsteht und notieren uns - so gut es eben geht - den unteren und oberen Stand des Schaumes zu unterschiedlichen Zeitpunkten. Die Differenz ist dann das Bierschaumvolumen zum jeweiligen Zeitpunkt.</p>
<p><img alt="" src="../_images/20190521_bierschaum_02.jpg" />
<img alt="" src="../_images/20190521_bierschaum_03.jpg" /></p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(t\)</span> [s]</p></th>
<th class="head"><p>Oberer Messwert [<span class="math notranslate nohighlight">\(l\)</span>]</p></th>
<th class="head"><p>Unterer Messwert [<span class="math notranslate nohighlight">\(l\)</span>]</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(V\)</span> [<span class="math notranslate nohighlight">\(l\)</span>]</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>11</p></td>
<td><p>0.600</p></td>
<td><p>0.025</p></td>
<td><p>0.575</p></td>
</tr>
<tr class="row-odd"><td><p>18</p></td>
<td><p>0.590</p></td>
<td><p>0.045</p></td>
<td><p>0.545</p></td>
</tr>
<tr class="row-even"><td><p>21</p></td>
<td><p>0.580</p></td>
<td><p>0.050</p></td>
<td><p>0.530</p></td>
</tr>
<tr class="row-odd"><td><p>27</p></td>
<td><p>0.570</p></td>
<td><p>0.075</p></td>
<td><p>0.495</p></td>
</tr>
<tr class="row-even"><td><p>32</p></td>
<td><p>0.570</p></td>
<td><p>0.085</p></td>
<td><p>0.485</p></td>
</tr>
<tr class="row-odd"><td><p>37</p></td>
<td><p>0.570</p></td>
<td><p>0.100</p></td>
<td><p>0.470</p></td>
</tr>
<tr class="row-even"><td><p>52</p></td>
<td><p>0.570</p></td>
<td><p>0.125</p></td>
<td><p>0.445</p></td>
</tr>
<tr class="row-odd"><td><p>96</p></td>
<td><p>0.555</p></td>
<td><p>0.150</p></td>
<td><p>0.400</p></td>
</tr>
<tr class="row-even"><td><p>149</p></td>
<td><p>0.510</p></td>
<td><p>0.175</p></td>
<td><p>0.335</p></td>
</tr>
<tr class="row-odd"><td><p>195</p></td>
<td><p>0.480</p></td>
<td><p>0.180</p></td>
<td><p>0.300</p></td>
</tr>
<tr class="row-even"><td><p>246</p></td>
<td><p>0.430</p></td>
<td><p>0.190</p></td>
<td><p>0.240</p></td>
</tr>
<tr class="row-odd"><td><p>301</p></td>
<td><p>0.400</p></td>
<td><p>0.195</p></td>
<td><p>0.205</p></td>
</tr>
<tr class="row-even"><td><p>362</p></td>
<td><p>0.370</p></td>
<td><p>0.199</p></td>
<td><p>0.171</p></td>
</tr>
<tr class="row-odd"><td><p>430</p></td>
<td><p>0.350</p></td>
<td><p>0.200</p></td>
<td><p>0.150</p></td>
</tr>
<tr class="row-even"><td><p>482</p></td>
<td><p>0.340</p></td>
<td><p>0.201</p></td>
<td><p>0.139</p></td>
</tr>
<tr class="row-odd"><td><p>541</p></td>
<td><p>0.300</p></td>
<td><p>0.205</p></td>
<td><p>0.095</p></td>
</tr>
<tr class="row-even"><td><p>601</p></td>
<td><p>0.270</p></td>
<td><p>0.208</p></td>
<td><p>0.062</p></td>
</tr>
</tbody>
</table>
<p>Die Genauigkeit der Messung sei mal dahin gestellt, es reicht zumindest aus, um einen Trend zu erkennen: Der Schaum baut sich anfänglich schneller ab als später, wenn nicht mehr viel Schaum da ist. Wenn wir von einem Messfehler von ca. <span class="math notranslate nohighlight">\(2 \cdot 0.02 = 0.04\)</span> Litern und ca. <span class="math notranslate nohighlight">\(1\)</span> Sekunde ausgehen, ergibt sich folgendes Bild</p>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hold</span> <span class="n">on</span>

<span class="o">%</span> <span class="n">plot</span> <span class="n">measurement</span>
<span class="o">%</span> <span class="n">Note</span><span class="p">:</span> <span class="n">The</span> <span class="n">syntax</span> <span class="n">of</span> <span class="n">the</span> <span class="n">errorbar</span> <span class="n">function</span> <span class="n">differs</span> <span class="ow">in</span> <span class="n">Matlab</span><span class="p">,</span> <span class="n">the</span> <span class="nb">next</span> <span class="n">line</span> <span class="n">only</span> <span class="n">works</span> <span class="k">with</span> <span class="n">Octave</span><span class="o">.</span> 
<span class="o">%</span> <span class="n">Refer</span> <span class="n">to</span> <span class="n">the</span> <span class="n">Matlab</span> <span class="n">Documentation</span> <span class="k">for</span> <span class="n">more</span> <span class="n">information</span><span class="o">.</span>
<span class="n">h_meas</span> <span class="o">=</span> <span class="n">errorbar</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">t_err</span><span class="p">,</span> <span class="n">V_err</span><span class="p">,</span> <span class="s1">&#39;~&gt;.&#39;</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s1">&#39;Measurement of beer foam volume over time&#39;</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time [s]&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;volume [liters]&#39;</span><span class="p">)</span>

<span class="o">%</span> <span class="n">plot</span> <span class="n">model</span>
<span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.001</span><span class="p">;</span>
<span class="n">b</span> <span class="o">=</span> <span class="mf">0.58</span><span class="p">;</span>
<span class="n">tfine</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">t</span><span class="p">(</span><span class="n">end</span><span class="p">),</span><span class="mi">100</span><span class="p">);</span>
<span class="n">yfine</span> <span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">tfine</span><span class="p">);</span>
<span class="n">h_model</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">tfine</span><span class="p">,</span> <span class="n">yfine</span><span class="p">);</span>

<span class="n">legend</span><span class="p">([</span><span class="n">h_meas</span><span class="p">,</span> <span class="n">h_model</span><span class="p">],{</span><span class="s1">&#39;measurement data&#39;</span><span class="p">,</span> <span class="s1">&#39;model with guessed parameters&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/01_bierschaumzerfall_2_0.png" src="../_images/01_bierschaumzerfall_2_0.png" />
</div>
</div>
</div>
<div class="section" id="modellbeschreibung">
<h2>Modellbeschreibung<a class="headerlink" href="#modellbeschreibung" title="Permalink to this headline">¶</a></h2>
<p>Der Schaum besteht aus vielen kleinen Bläschen, die nach und nach platzen. Je mehr Schaum da ist, d.h. je mehr Bläschen da sind, desto mehr Bläschen platzen auch. Ist der Schaum schon fast komplett abgebaut, bleiben insgesamt weniger Bläschen die platzen können, und die Zerfallsrate des Bierschaumes sinkt entsprechend. Mathematisch ausgedrückt ist die zeitliche Änderung <span class="math notranslate nohighlight">\(\dot{V}\)</span> des Schaumvolumens proportional zur Menge des Schaumvolumens selbst, d.h. es gilt</p>
<div class="math notranslate nohighlight">
\[ \dot{V} = a \cdot V, \]</div>
<p>mit einer uns unbekannten Proportionalitätskonstante <span class="math notranslate nohighlight">\(a \in \mathbb{R}\)</span>. Diese Differentialgleichung kommt sehr häufig vor, denn sie beschreibt exponentielles Wachstum, bzw. - je nach Vorzeichen von <span class="math notranslate nohighlight">\(a\)</span> - exponentiellen Zerfall. Wir machen also, wie gewohnt, einen Ansatz</p>
<div class="math notranslate nohighlight">
\[ V(t) = b \cdot e^{c \cdot t}.\]</div>
<p>Setzen wir <span class="math notranslate nohighlight">\(V(t)\)</span> in die Differentialgleichung $ \dot{V} = a \cdot V $ ein,</p>
<div class="math notranslate nohighlight">
\[ c b \cdot e^{c \cdot t} = a \cdot b e^{c \cdot t}, \]</div>
<p>stellen wir fest, dass unser Ansatz eine valide Lösung der Differentialgleichung ist, unter der Voraussetzung, dass <span class="math notranslate nohighlight">\(c = a\)</span> gilt.</p>
<div class="math notranslate nohighlight">
\[ V(t) = b \cdot e^{a \cdot t}. \]</div>
<p>Ok, nun haben wir einerseits Messwerte und andererseits ein mathematisches Modell mit unbekannten Parametern <span class="math notranslate nohighlight">\(a\)</span> und <span class="math notranslate nohighlight">\(b\)</span>. <span class="math notranslate nohighlight">\(b\)</span> muss offensichtlich der y-Achsenabschnitt sein, da <span class="math notranslate nohighlight">\(V(0)=b \cdot e^0 = b\)</span>, den kennen wir aus den Messwerten. Aber was, wenn ausgerechnet die erste Messung mit Messfehlern behaftet ist? Abgesehen, davon haben wir auch dann noch Schwierigkeiten händisch die Zerfallsrate <span class="math notranslate nohighlight">\(a\)</span> zu raten. Für <span class="math notranslate nohighlight">\(a=-0.001 \frac{1}{\text{s}}\)</span> und <span class="math notranslate nohighlight">\(b=0.575\)</span> <span class="math notranslate nohighlight">\(l\)</span> ergibt sich folgender Verlauf.</p>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hold</span> <span class="n">on</span>

<span class="o">%</span> <span class="n">plot</span> <span class="n">measurement</span>
<span class="o">%</span> <span class="n">Note</span><span class="p">:</span> <span class="n">The</span> <span class="n">syntax</span> <span class="n">of</span> <span class="n">the</span> <span class="n">errorbar</span> <span class="n">function</span> <span class="n">differs</span> <span class="ow">in</span> <span class="n">Matlab</span><span class="p">,</span> <span class="n">the</span> <span class="nb">next</span> <span class="n">line</span> <span class="n">only</span> <span class="n">works</span> <span class="k">with</span> <span class="n">Octave</span><span class="o">.</span> 
<span class="o">%</span> <span class="n">Refer</span> <span class="n">to</span> <span class="n">the</span> <span class="n">Matlab</span> <span class="n">Documentation</span> <span class="k">for</span> <span class="n">more</span> <span class="n">information</span><span class="o">.</span>
<span class="n">h_meas</span> <span class="o">=</span> <span class="n">errorbar</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">t_err</span><span class="p">,</span> <span class="n">V_err</span><span class="p">,</span> <span class="s1">&#39;~&gt;.&#39;</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s1">&#39;Measurement of beer foam volume over time&#39;</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time [s]&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;volume [liters]&#39;</span><span class="p">)</span>

<span class="o">%</span> <span class="n">plot</span> <span class="n">model</span>
<span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.001</span><span class="p">;</span>
<span class="n">b</span> <span class="o">=</span> <span class="mf">0.58</span><span class="p">;</span>
<span class="n">tfine</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">t</span><span class="p">(</span><span class="n">end</span><span class="p">),</span><span class="mi">100</span><span class="p">);</span>
<span class="n">yfine</span> <span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">tfine</span><span class="p">);</span>
<span class="n">h_model</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">tfine</span><span class="p">,</span> <span class="n">yfine</span><span class="p">);</span>

<span class="n">legend</span><span class="p">([</span><span class="n">h_meas</span><span class="p">,</span> <span class="n">h_model</span><span class="p">],{</span><span class="s1">&#39;measurement data&#39;</span><span class="p">,</span> <span class="s1">&#39;model with guessed parameters&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/01_bierschaumzerfall_4_0.png" src="../_images/01_bierschaumzerfall_4_0.png" />
</div>
</div>
<p>Wir können immer noch keine quantifizierbare Aussage darüber treffen, wie schnell das Bier sich abbaut.</p>
<p>Wie können wir <span class="math notranslate nohighlight">\(a\)</span> und <span class="math notranslate nohighlight">\(b\)</span> so bestimmen, dass das Modell zu unseren Messwerten passt? Wenn wir das wüssten, könnten wir auf Grundlage der Modellgleichung Vorhersagen treffen.</p>
</div>
<div class="section" id="die-methode-der-kleinsten-quadrate">
<h2>Die Methode der kleinsten Quadrate<a class="headerlink" href="#die-methode-der-kleinsten-quadrate" title="Permalink to this headline">¶</a></h2>
<p>Die Methode der kleinsten Quadrate ist eine weit verbreitete Methode zur Modellkalibrierung. Mit ihr können noch unbekannte Parameter <span class="math notranslate nohighlight">\(p_1,...,p_n\)</span> eines Modells <span class="math notranslate nohighlight">\(y = f(p_1,...,p_n,t)\)</span> so angepasst werden, dass es vorher ermittelte experimentelle Daten <span class="math notranslate nohighlight">\((t_1,y_1),...,(t_m, y_m)\)</span> möglichst gut wiederspiegelt.</p>
<div class="section" id="die-grundidee">
<h3>Die Grundidee<a class="headerlink" href="#die-grundidee" title="Permalink to this headline">¶</a></h3>
<p>Wir formulieren ein Minimierungsproblem: Für alle Messpunkte <span class="math notranslate nohighlight">\(t_i\)</span> soll die Differenz <span class="math notranslate nohighlight">\(y_i - f(p_1,...,p_n,t_i)\)</span> betragsmäßig klein werden.</p>
<p>Für die Formulierung stehen verschiedene Ansätze zur Verfügung. Man könnte einfach den Mittelwert der betragsmäßigen Differenzen über alle Messpunkte minimieren:</p>
<div class="math notranslate nohighlight">
\[ \min_{p_1,...,p_n} G(p_1,...,p_n) = \frac{1}{m} \sum_{i=1}^m |y_i - f(p_1,...,p_n,t_i)|  \]</div>
<p>Wenn die Funktion <span class="math notranslate nohighlight">\(G\)</span> minimal werden soll, muss die Ableitung von <span class="math notranslate nohighlight">\(G\)</span> nach allen Parametern verschwinden,</p>
<div class="math notranslate nohighlight">
\[ \frac{\partial G}{\partial p_1} = ... = \frac{\partial G}{\partial p_n} = 0. \]</div>
<p>Spätestens jetzt haben wir ein Problem: Wir müssen die Betragsfunktion, die in <span class="math notranslate nohighlight">\(G\)</span> verwendet wird, ableiten.</p>
<p>Als Alternative nehmen wir nicht den Betrag der Differenzen, sondern einfach das Quadrat. Auf diese Weise werden positive und negative Differenzen gleich berücksichtigt. Es hat auch noch den angenehmen Nebeneffekt, dass große Abweichungen zwischen Modell und Messung größer bestraft werden als kleine Abweichungen:</p>
<div class="math notranslate nohighlight">
\[ \min_{p_1,...,p_n} G(p_1,...,p_n) = \frac{1}{m} \sum_{i=1}^m (y_i - f(p_1,...,p_n,t_i))^2  \]</div>
<p>Das Minimierungsproblem lösen wir, indem wir die Bedingung aufstellen, dass alle Ableitungen von <span class="math notranslate nohighlight">\(G\)</span> nach den Parametern null sein sollen und nach den Parametern auflösen. Die partiellen Ableitungen bestimmen wir mit der Kettenregel:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\boldsymbol{0} = 
\begin{bmatrix}
0 \\ \vdots \\ 0
\end{bmatrix} = F(\mathbf{p}) =
\begin{bmatrix} 
\frac{\partial G}{\partial p_1}(p_1,...,p_n)  \\
\vdots \\
\frac{\partial G}{\partial p_n}(p_1,...,p_n)
\end{bmatrix}
=
\begin{bmatrix}
-\frac{2}{m}\sum_{i=1}^m (y_i - f(p_1,...,p_n,t_i))\cdot \frac{\partial f}{\partial p_1}(p_1,...,p_n) \\
\vdots \\
-\frac{2}{m}\sum_{i=1}^m (y_i - f(p_1,...,p_n,t_i))\cdot \frac{\partial f}{\partial p_n}(p_1,...,p_n) \\
\end{bmatrix}
\end{split}\]</div>
</div>
<div class="section" id="anwendung-auf-den-bierschaum">
<h3>Anwendung auf den Bierschaum<a class="headerlink" href="#anwendung-auf-den-bierschaum" title="Permalink to this headline">¶</a></h3>
<p>Im Falle des Bierschaumes gilt <span class="math notranslate nohighlight">\(p_1 = a, p_2 = b\)</span> und</p>
<div class="math notranslate nohighlight">
\[ f(a,b,t) = b\cdot e^{a \cdot t}. \]</div>
<p>Das nichtlineare Gleichungssystem, das gelöst werden muss lautet also</p>
<div class="math notranslate nohighlight">
\[\begin{split} 
\boldsymbol{0} = F(a,b) = 
\begin{bmatrix}
\frac{\partial G}{\partial a} (a,b) \\
\frac{\partial G}{\partial b} (a,b) 
\end{bmatrix} = 
\begin{bmatrix}
-\frac{2}{m}\sum_{i=1}^m (V_i - b \cdot e^{a \cdot t_i})\cdot  t_i \cdot b \cdot e^{a \cdot t_i} \\
-\frac{2}{m}\sum_{i=1}^m (V_i - b \cdot e^{a \cdot t_i}) \cdot e^{a \cdot t_i}
\end{bmatrix}
\end{split}\]</div>
<p>Im Folgenden wird das Problem schrittweise gelöst.</p>
<ol class="simple">
<li><p>Wir implementieren eine Matlab-Funktion, mit der wir <span class="math notranslate nohighlight">\(F\)</span> auswerten können.</p></li>
<li><p>Wir implementieren eine Matlab-Funktion, die uns für eine gegebene Funktion <span class="math notranslate nohighlight">\(F\)</span> die Jacobimatrix ausrechnet.</p></li>
<li><p>Wir implementieren das Newton-Verfahren unter Zuhilfenahme der Funktion für die Jacobimatrix. Anschließend wenden wir das Newton-Verfahren auf <span class="math notranslate nohighlight">\(F\)</span> an, um unsere Parameter zu bestimmen.</p></li>
<li><p>Auf Basis unserer Funktion für das Newtonverfahren und unserer Funktion für die Jacobimatrix schreiben wir ein Programm zur Minimierung beliebiger skalarer Funktionen.</p></li>
</ol>
</div>
<div class="section" id="aufgabe-1-das-nichtlineare-gleichungssystem">
<h3>Aufgabe 1: Das nichtlineare Gleichungssystem<a class="headerlink" href="#aufgabe-1-das-nichtlineare-gleichungssystem" title="Permalink to this headline">¶</a></h3>
<p>Schreiben Sie eine Matlab-Funktion, die die nichtlineare Gleichung <span class="math notranslate nohighlight">\(F\)</span> für beliebige Parameter <span class="math notranslate nohighlight">\(\mathbf{p}=[a,b]^T \in \mathbb{R}^2\)</span> und Messwerte <span class="math notranslate nohighlight">\(t \in \mathbb{R}^m\)</span>, <span class="math notranslate nohighlight">\(V \in \mathbb{R}^m\)</span> auswertet:</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">file</span> <span class="n">F</span><span class="o">.</span><span class="n">m</span>
<span class="n">function</span> <span class="n">e</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">V</span><span class="p">)</span>
<span class="o">%</span> <span class="n">define</span> <span class="n">the</span> <span class="n">nonlinear</span> <span class="n">system</span> <span class="n">of</span> <span class="n">equations</span> <span class="n">that</span> <span class="n">need</span> <span class="n">to</span> <span class="n">be</span> <span class="n">solved</span> <span class="n">within</span> <span class="n">the</span> <span class="n">least</span> <span class="n">squares</span> <span class="n">fit</span>
<span class="o">%</span> <span class="n">of</span> <span class="n">the</span> <span class="n">beer</span> <span class="n">froth</span> <span class="n">experiment</span>
<span class="o">%</span>
<span class="o">%</span> <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="s1">&#39; is a vector of the model parameters</span>
<span class="o">%</span>
<span class="o">%</span> <span class="n">t</span> <span class="ow">and</span> <span class="n">V</span> <span class="n">are</span> <span class="n">vectors</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">experimental</span> <span class="n">data</span>

<span class="o">%</span> <span class="n">PUT</span> <span class="n">YOUR</span> <span class="n">CODE</span> <span class="n">HERE</span>
</pre></div>
</div>
</div>
</div>
<p>Damit haben Sie eine Funktion geschrieben, mit der Sie Ihr nichtlineares Gleichungssystem auswerten können. Damit alleine können Sie noch nicht so viel anfangen. In den folgenden beiden Aufgaben geht es nun darum, die Nullstellen dieser Funktion zu finden, um die beiden Parameter <span class="math notranslate nohighlight">\(a\)</span> und <span class="math notranslate nohighlight">\(b\)</span> bestimmen zu können.</p>
</div>
</div>
<div class="section" id="das-newton-verfahren">
<h2>Das Newton-Verfahren<a class="headerlink" href="#das-newton-verfahren" title="Permalink to this headline">¶</a></h2>
<p>Aus der Vorlesung kennen Sie das Newton-Verfahren zum Lösen nichtlinearer Gleichungssysteme. Angefangen mit einem Startwert <span class="math notranslate nohighlight">\(\mathbf{p}^{(0)}\)</span> muss in jeder Iteration ein lineares Gleichungssystem gelöst werden:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
 J_F(\mathbf{p}^{(i)}) \Delta \mathbf{p}^{(i+1)} &amp;= - F(\mathbf{p}^{(i)}), \notag \\
 \mathbf{p}^{(i+1)} &amp;= \mathbf{p}^{(i)} + \Delta \mathbf{p}^{(i+1)}, \notag
\end{align}
\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(i=1,2,3,...\)</span></p>
<p>Um die Jacobi-Matrix <span class="math notranslate nohighlight">\(J_F(\mathbf{p}^{(i)})\)</span> in jeder Iteration zu bestimmen, müssen wir die partiellen Ableitungen von <span class="math notranslate nohighlight">\(F\)</span> nach <span class="math notranslate nohighlight">\(p_1 = a\)</span> und <span class="math notranslate nohighlight">\(p_2=b\)</span> ausrechnen. Theoretisch kann man das in unserem Fall noch analytisch machen. Einfacher ist es aber, die Jacobi-Matrix mittels finiter Differenzen zu approximieren. Dadurch verlieren wir zwar an Genauigkeit, aber wir können unser Verfahren dadurch auch auf komplexere Modellgleichungen anwenden, die sich nicht mehr so einfach ableiten lassen.</p>
<div class="section" id="aufgabe-2-approximation-der-jacobi-matrix">
<h3>Aufgabe 2: Approximation der Jacobi-Matrix<a class="headerlink" href="#aufgabe-2-approximation-der-jacobi-matrix" title="Permalink to this headline">¶</a></h3>
<p>Schreiben Sie eine Matlab-Funktion, die die Jacobimatrix <span class="math notranslate nohighlight">\(J_F(\mathbf{x})\)</span> für eine beliebige Funktion <span class="math notranslate nohighlight">\(F:\mathbb{R}^n \to \mathbb{R}^m\)</span> mit Differenzenquotienten (<em>“finiten Differenzen”</em>) approximiert. Dabei soll die Eingabe <code class="docutils literal notranslate"><span class="pre">F</span></code> ein <em><a class="reference external" href="https://de.mathworks.com/help/matlab/matlab_prog/creating-a-function-handle.html">function handle</a></em> einer beliebigen Funktion sein, beispielsweise <code class="docutils literal notranslate"><span class="pre">&#64;sin</span></code> oder <code class="docutils literal notranslate"><span class="pre">&#64;(x)</span> <span class="pre">[x(1)^2;</span> <span class="pre">cos(x(2))]</span></code>.</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">file</span> <span class="n">jacobian</span><span class="o">.</span><span class="n">m</span>
<span class="n">function</span> <span class="n">J</span> <span class="o">=</span> <span class="n">jacobian</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="o">%</span> <span class="n">J</span> <span class="o">=</span> <span class="n">jacobian</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="n">returns</span> <span class="n">the</span> <span class="p">(</span><span class="n">m</span> <span class="n">x</span> <span class="n">n</span><span class="p">)</span> <span class="n">Jacobian</span> <span class="n">matrix</span> <span class="n">of</span> <span class="n">F</span> <span class="n">evaluated</span> <span class="n">at</span> <span class="n">x</span>
<span class="o">%</span>
<span class="o">%</span>   <span class="o">|</span>  <span class="n">dF1</span><span class="o">/</span><span class="n">dx1</span> <span class="o">...</span> <span class="n">dF1</span><span class="o">/</span><span class="n">dxn</span> <span class="o">|</span>
<span class="o">%</span>   <span class="o">|</span>     <span class="o">.</span>           <span class="o">.</span>    <span class="o">|</span>
<span class="o">%</span>   <span class="o">|</span>  <span class="n">dFm</span><span class="o">/</span><span class="n">dx1</span> <span class="o">...</span> <span class="n">dFm</span><span class="o">/</span><span class="n">dxn</span> <span class="o">|</span>
<span class="o">%</span>
<span class="o">%</span> <span class="n">It</span> <span class="n">uses</span> <span class="n">finite</span> <span class="n">difference</span> <span class="n">approximations</span><span class="o">.</span> <span class="n">x</span> <span class="n">must</span> <span class="n">be</span> <span class="n">a</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">column</span> <span class="n">vector</span> <span class="ow">and</span> <span class="n">F</span> <span class="n">must</span> <span class="n">be</span> <span class="n">a</span> <span class="n">function</span>
<span class="o">%</span> <span class="n">taking</span> <span class="n">an</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">vector</span> <span class="k">as</span> <span class="n">an</span> <span class="nb">input</span><span class="o">.</span> <span class="n">m</span> <span class="ow">is</span> <span class="n">deduced</span> <span class="kn">from</span> <span class="nn">F.</span>

<span class="o">%</span> <span class="n">PUT</span> <span class="n">YOUR</span> <span class="n">CODE</span> <span class="n">HERE</span>
</pre></div>
</div>
</div>
</div>
<p>Wenn Sie Ihre Funktion richtig implementiert haben, wären Sie in der Lage mit folgendem Aufruf die Ableitung von <span class="math notranslate nohighlight">\(sin(x)\)</span> an der Stelle <span class="math notranslate nohighlight">\(x=0.25\)</span> auszuwerten:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jacobian</span><span class="p">(</span><span class="nd">@sin</span><span class="p">,</span><span class="mf">0.25</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Hinweise:</strong></p>
<ul class="simple">
<li><p>Machen Sie sich mit <em>function handles</em> und <em>anonymous functions</em> in Matlab vertraut.</p></li>
<li><p>Implementieren Sie eine Schleife über die Spalten der Jacobi-Matrix, pro Spalte müssen Sie einen Differenzenquotienten bilden.</p></li>
<li><p>Ihr Programm sollte mit <span class="math notranslate nohighlight">\(n+1\)</span> Funktionsaufrufen von <code class="docutils literal notranslate"><span class="pre">F</span></code> auskommen.</p></li>
<li><p>Achten Sie darauf, dass alle Funktionen <span class="math notranslate nohighlight">\(F: \mathbb{R}^n \to \mathbb{R}^m\)</span> auf die Sie die <code class="docutils literal notranslate"><span class="pre">jacobian</span></code> Funktion anwenden <em>Spalten</em>vektoren auf <em>Spalten</em>vektoren abbilden.</p></li>
</ul>
<p>Mit dem folgenden unit test können Sie Ihre Funktion testen:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">moxunit_runtests</span> <span class="n">test_jacobian</span><span class="o">.</span><span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p>Es gilt <code class="docutils literal notranslate"><span class="pre">F(p,t,V)</span></code> $= J_G(\mathbf{p})^T
$ mit</p>
<div class="math notranslate nohighlight">
\[
G(\mathbf{p}) = \frac{1}{m} \sum_{i=1}^m (y_i - f(\mathbf{p},t_i))^2.
\]</div>
<p>Einerseits haben Sie in Aufgabe 1 eine Funktion geschrieben, die <code class="docutils literal notranslate"><span class="pre">F</span></code> berechnet, andererseits können Sie mit Ihrer Funktion aus Aufgabe 2 die Jacobi-Matrix <span class="math notranslate nohighlight">\(J_G(\mathbf{p})\in \mathbb{R}^{1 \times n}\)</span> mit Hilfe von Differenzenquotienten approximieren. Vergleichen Sie die beiden Ergebnisse für verschiedene <span class="math notranslate nohighlight">\(\mathbf{p}\)</span>. In welcher Größenordung befindet sich in etwa der relative Fehler der Funktion <code class="docutils literal notranslate"><span class="pre">jacobian</span></code> für Ihr Problem?</p>
</div>
<div class="section" id="aufgabe-3-parameterbestimmung">
<h3>Aufgabe 3: Parameterbestimmung<a class="headerlink" href="#aufgabe-3-parameterbestimmung" title="Permalink to this headline">¶</a></h3>
<p>Schreiben Sie eine Matlab-Funktion, die das Newton-Verfahren implementiert. Verwenden Sie dazu Ihre Funktion <code class="docutils literal notranslate"><span class="pre">jacobian</span></code> aus Aufgabe 2.</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">file</span> <span class="n">newton</span><span class="o">.</span><span class="n">m</span>
<span class="n">function</span> <span class="n">z</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">func</span><span class="p">,</span><span class="n">z0</span><span class="p">,</span><span class="n">tol</span><span class="p">,</span><span class="n">maxit</span><span class="p">)</span>
<span class="o">%</span> <span class="n">z</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">z0</span><span class="p">,</span><span class="n">tol</span><span class="p">,</span><span class="n">maxit</span><span class="p">)</span> <span class="n">solves</span> <span class="n">the</span> <span class="n">nonlinear</span> <span class="n">system</span> <span class="mi">0</span><span class="o">=</span><span class="n">func</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="o">%</span>
<span class="o">%</span> <span class="n">inputs</span><span class="p">:</span>
<span class="o">%</span>   <span class="n">func</span>    <span class="n">a</span> <span class="n">handle</span> <span class="n">to</span> <span class="n">the</span> <span class="n">nonlinear</span> <span class="n">function</span>
<span class="o">%</span>   <span class="n">z0</span>      <span class="n">initial</span> <span class="n">guess</span> <span class="k">for</span> <span class="n">the</span> <span class="n">Newton</span> <span class="n">method</span>
<span class="o">%</span>   <span class="n">atol</span>    <span class="n">absolute</span> <span class="n">tolerance</span>
<span class="o">%</span>   <span class="n">maxit</span>   <span class="n">maximum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">Newton</span> <span class="n">iterations</span>

<span class="o">%</span> <span class="n">YOUR</span> <span class="n">CODE</span> <span class="n">HERE</span>
</pre></div>
</div>
</div>
</div>
<p>Mit dem folgenden unit test können Sie Ihre Funktion testen:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">moxunit_runtests</span> <span class="n">test_newton</span><span class="o">.</span><span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Wenden Sie das Newton-Verfahren auf die Funkton <code class="docutils literal notranslate"><span class="pre">func</span> <span class="pre">=</span> <span class="pre">&#64;(p)</span> <span class="pre">F(p,t,V)</span></code> an, um das ursprüngliche nichtlineare Gleichungssystem zu lösen. Wählen Sie angemessene Werte für die Toleranz und die maximale Anzahl an Iterationen. Wie lauten die Parameter <span class="math notranslate nohighlight">\(a\)</span> und <span class="math notranslate nohighlight">\(b\)</span> Ihrer Modellfunktion?</p></li>
<li><p>Vergleichen Sie Ihr Ergebnis mit dem Ergebnis der Matlab-Funktion <code class="docutils literal notranslate"><span class="pre">fsolve</span></code>.</p></li>
<li><p>Erstellen Sie einen Plot mit den Messwerten, sowie der kalibrierten Modellfunktion <span class="math notranslate nohighlight">\(V(t) = b \cdot e^{a \cdot t}\)</span>.</p></li>
<li><p>Wie lautet die Halbwertzeit des Bierschaumes?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">SPACE</span> <span class="n">FOR</span> <span class="n">SOLUTION</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="optimierungsverfahren">
<h2>Optimierungsverfahren<a class="headerlink" href="#optimierungsverfahren" title="Permalink to this headline">¶</a></h2>
<p>Grundlage der Methode der kleinsten Quadrate ist ein Minimierungsproblem. Wir haben gesehen, dass sich das Minimum einer Funktion <span class="math notranslate nohighlight">\(G: \mathbb{R}^n \to \mathbb{R}\)</span> bestimmen lässt, indem das nichtlineare Gleichungssystem</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  \boldsymbol{0} = J_G(\mathbf{p})^T = 
  \begin{bmatrix}  
  \frac{\partial G}{\partial p_1}(\mathbf{p}) \\
  \vdots \\
  \frac{\partial G}{\partial p_n}(\mathbf{p})
  \end{bmatrix}
\end{split}\]</div>
<p>mit dem Newton-Verfahren nach <span class="math notranslate nohighlight">\(\mathbf{p}\)</span> gelöst wird. Die Iterationsvorschrift lautet</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
J_{J_G}(\mathbf{p}^{(i)}) \Delta \mathbf{p}^{(i+1)} &amp;= - J_G(\mathbf{p}^{(i)})^T \notag \\
\mathbf{p}^{(i+1)} &amp;= \mathbf{p}^{(i)} + \Delta \mathbf{p}^{(i)}, \notag
\end{align}
\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(i=1,2,3,...\)</span> Hierbei ist <span class="math notranslate nohighlight">\(J_G(\mathbf{p}^{(i)}) \in \mathbb{R}^n\)</span> die Jacobimatrix von <span class="math notranslate nohighlight">\(G\)</span>. Die Jacobimatrix von <span class="math notranslate nohighlight">\(J_G(\mathbf{p}^{(i)})^T\)</span> wiederum ist <span class="math notranslate nohighlight">\(J_{J_G}(\mathbf{p}^{(i)}) \in \mathbb{R}^{n \times n}\)</span>. Sie wird auch als <em>Hessematrix von <span class="math notranslate nohighlight">\(G\)</span></em> an der Stelle <span class="math notranslate nohighlight">\(\mathbf{p}^{(i)}\)</span> bezeichnet und beinhaltet die zweiten Ableitungen der Funktion <span class="math notranslate nohighlight">\(G\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
Hess_G(\mathbf{p}) = J_{J_G}(\mathbf{p}) =
\begin{bmatrix}
\frac{\partial}{\partial p_0} \frac{\partial G}{\partial p_0}(\mathbf{p}) &amp; \cdots &amp; \frac{\partial}{\partial p_n} \frac{\partial G}{\partial p_0}(\mathbf{p}) \\
\vdots &amp; \ddots &amp; \vdots \\
\frac{\partial}{\partial p_0} \frac{\partial G}{\partial p_n}(\mathbf{p}) &amp; \cdots &amp; \frac{\partial}{\partial p_n} \frac{\partial G}{\partial p_n}(\mathbf{p})
\end{bmatrix}
\end{split}\]</div>
<p>Zusammenfassend kann ein Minimierungsproblem also gelöst werden, indem es auf ein nichtlineares Gleichungssystem zurückgeführt wird. Dieses wiederum kann mit Hilfe des Newtonverfahren gelöst werden. In jeder Iteration des Newtonverfahrens muss ein lineares Gleichungssystem gelöst werden.</p>
<div class="section" id="aufgabe-4-algorithmus-zur-minimierung-einer-funktion">
<h3>Aufgabe 4: Algorithmus zur Minimierung einer Funktion<a class="headerlink" href="#aufgabe-4-algorithmus-zur-minimierung-einer-funktion" title="Permalink to this headline">¶</a></h3>
<p>Schreiben Sie eine neue Funktion <code class="docutils literal notranslate"><span class="pre">minimize(func,x0,tol,maxit)</span></code> auf Grundlage Ihrer Implementierung für das Newtonverfahren, die eine beliebige Funktion <code class="docutils literal notranslate"><span class="pre">func</span></code><span class="math notranslate nohighlight">\(: \mathbb{R}^n \to \mathbb{R}\)</span> minimiert. Verwenden Sie Ihre Funktion <code class="docutils literal notranslate"><span class="pre">jacobian</span></code>, um die Hessematrix sowie die rechte Seite in jedem Funktionsaufruf zu konstruieren.</p>
<ul>
<li><p>Lösen Sie das ursprüngliche Minimierungsproblem</p>
<div class="math notranslate nohighlight">
\[ \min_{p_1,...,p_n} G(p_1,...,p_n) = \frac{1}{m} \sum_{i=1}^m (y_i - f(p_1,...,p_n,t_i))^2  \]</div>
</li>
</ul>
<p>mit Ihrer neuen Funktion und vergleichen Sie das Ergebnis mit Ihrem Ergebnis aus Aufgabe 3 sowie dem Resultat der Matlab-Funktion <code class="docutils literal notranslate"><span class="pre">fminsearch</span></code>.</p>
<ul class="simple">
<li><p>Wo sind die Grenzen Ihres Algorithmus? Gibt es mögliche Fehlerquellen, die Nutzer Ihrer Funktion beachten sollten?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">file</span> <span class="n">minimize</span><span class="o">.</span><span class="n">m</span>

<span class="o">%</span><span class="n">SPACE</span> <span class="n">FOR</span> <span class="n">SOLUTION</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Hinweis:</strong> <em>Wenn Sie Ihr Ergebnis aus Aufgaben 2 und 3 wiederverwenden, können Sie die Funktion mit nur 1-2 Zeilen implementieren.</em> Vermeiden Sie duplizierten Code!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">SPACE</span> <span class="n">FOR</span> <span class="n">SCRIPT</span> <span class="n">SOLUTION</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="zusatzliche-informationen">
<h3>Zusätzliche Informationen<a class="headerlink" href="#zusatzliche-informationen" title="Permalink to this headline">¶</a></h3>
<p>Zusätzliche Informationen zum Verfall von Bierschaum finden Sie in <a class="bibtex reference internal" href="#theissen2009" id="id1">[The09]</a> und <a class="bibtex reference internal" href="#leike2001" id="id2">[Lei01]</a>.</p>
</div>
</div>
<div class="section" id="literatur">
<h2>Literatur<a class="headerlink" href="#literatur" title="Permalink to this headline">¶</a></h2>
<p id="bibtex-bibliography-04_nichtlineare_gleichungen/01_bierschaumzerfall-0"><dl class="citation">
<dt class="bibtex label" id="leike2001"><span class="brackets"><a class="fn-backref" href="#id2">Lei01</a></span></dt>
<dd><p>A Leike. Demonstration of the exponential decay law using beer froth. <em>European Journal of Physics</em>, 23(1):21–26, dec 2001. URL: <a class="reference external" href="https://doi.org/10.1088%2F0143-0807%2F23%2F1%2F304">https://doi.org/10.1088%2F0143-0807%2F23%2F1%2F304</a>, <a class="reference external" href="https://doi.org/10.1088/0143-0807/23/1/304">doi:10.1088/0143-0807/23/1/304</a>.</p>
</dd>
<dt class="bibtex label" id="theissen2009"><span class="brackets"><a class="fn-backref" href="#id1">The09</a></span></dt>
<dd><p>H Theißen. Mythos bierschaumzerfall - ein analogon für den radioaktiven zerfall? <em>PhyDid A - Physik und Didaktik in Schule und Hochschule</em>, 2009. URL: <a class="reference external" href="http://phydid.physik.fu-berlin.de/index.php/phydid/article/view/87">http://phydid.physik.fu-berlin.de/index.php/phydid/article/view/87</a>.</p>
</dd>
</dl>
</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "joergbrech/Modellbildung-und-Simulation",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "04_nichtlineare_gleichungen"
        }
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="00_nichtlineare_gleichungssysteme.html" title="previous page">Nichtlineare Gleichungssysteme</a>
    <a class='right-next' id="next-link" href="../05_interp_approx/00_interpolation_Und_approximation.html" title="next page">Interpolation und Approximation</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Jan Kleinert<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-134708516-1', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    
  </body>
</html>